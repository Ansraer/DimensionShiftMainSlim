Slimmed down version of my recent second attempt at writing a complete DS mod.
